@model BankAccountViewModel

@{
    Layout = "_LayoutBank";
}

@using SpaceWeb.Service
@using AutoMapper

@inject UserService userService
@inject IMapper mapper
@{
    var accountIndex = 0;
    var user = userService.GetCurrent();
    var accounts = new List<BankAccountViewModel>();
    foreach (var accountBD in user.BankAccounts)
    {
        accounts.Add(mapper.Map<BankAccountViewModel>(accountBD));
    }
}

@section Scripts{
    <script src="~/js/bank/bankAccountCarousel.js"></script>
    <script src="~/js/bank/bankAccountIndex.js"></script>
}

@section Style{
    <link rel="stylesheet" href="~/css/bank/styleAccount.css?v=0" />
}

<body>
    <div class="client-before-content"></div>

    <div class="account-index-central-block">
        <div class="menu left">
            <div class="left-menu-text">СЧЕТА: <span class="total-accounts">@accounts.Count()</span></div>
            @Html.Partial("_bankAccountsList")
        </div>
        <div class="account-container">

            <div class="account-changer">

                <div class="changer-buttons">
                    <div class="prev-btn button"> Назад </div>
                    <div class="next-btn button"> Вперде </div>
                </div>

                <div class="account-view-window">
                    <div class="account-carousel">
                        @foreach (var bankAccount in accounts)
                        {
                            <div class="account-info-container @accountIndex">
                                <div class="account-info">
                                    <div class="info index hide">@(accountIndex++)</div>
                                    <div class="info type">@bankAccount.Name</div>
                                    <div class="info amount">@bankAccount.Amount @bankAccount.Currency.ToString()</div>
                                    <div class="info number">@bankAccount.AccountNumber</div>
                                    <div class="info creation">Создан: @bankAccount.CreationDate.Month/@bankAccount.CreationDate.Year</div>
                                    <div class="info expire">Действителен до: @bankAccount.ExpireDate.Month/@bankAccount.ExpireDate.Year</div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
            <div class="content-box">
                <div class="button-list">
                    <input class="active-account hide" type="hidden" value="@Model.AccountIndex">

                    <div class="button deposit show-menu">Пополнить счет</div>

                    <div class="button withdrawal show-menu">Снять со счета</div>

                    <div class="button">Заморозить счет</div>

                    <a href="/Account/DownloadLog?id=@Model.Id">
                        <div class="button">История операций</div>
                    </a>                            
                    
                    <div class="button transfer show-menu">Перевод со счета</div>

                    <a href="/Account/Remove?id=@Model.Id">
                        <div class="button">Удалить счет</div>
                    </a>
                </div>

                <div class="deposit-form container hide">
                    <div class="head-text">ПОПОЛНЕНИЕ СЧЕТА</div>
                    <form class="deposit form" method="POST">
                        <div>Сумма для пополнения</div>
                        <input type="text" autocomplete="off">
                        <p class="buttons">
                            <input class="make deposit button" type="submit" value="Пополнить">
                            <input class="cancel deposit button" type="reset" value="Отмена">
                        </p>
                    </form>
                </div>

                <div class="withdrawal-form container hide">
                    <div class="head-text">СНЯТИЕ СО СЧЕТА</div>
                    <form class="withdrawal form" method="POST">
                        <div>Сумма для снятия</div>
                        <input type="text" autocomplete="off">
                        <p class="buttons">
                            <input class="make withdrawal button" type="submit" value="Снять">
                            <input class="cancel withdrawal button" type="reset" value="Отмена">
                        </p>
                    </form>
                </div>

                <div class="transfer-form container hide">
                    <div class="head-text">ПЕРЕВОД СО СЧЕТА</div>
                    <form class="transfer form" method="POST">
                        <div>Номер счета получателя</div>
                        <input type="text" autocomplete="off">
                        <div>Сумма перевода</div>
                        <input type="text" autocomplete="off">
                        <p class="buttons">
                            <input class="make transfer button" type="submit" value="Перевести">
                            <input class="cancel transfer button" type="reset" value="Отмена">
                        </p>
                    </form>
                </div>

            </div>
        </div>
    </div>
</body>